function Task(e,t,o,n){var a=this,s=e;App.newDate(),a.id=ko.computed(function(){return s}),a.name=ko.observable(t),a.complete=ko.observable(o),a.completeYesterday=ko.observable(n),a.toJSON=function(){return{Id:a.id(),Name:a.name(),Complete:a.complete(),CompleteYesterday:a.completeYesterday()}}}function AppModel(e,t){"use strict";function o(){return Math.random()*(1e15-1)+1}var n=this,a=App.newDate(),s=new Date(a);s=new Date(s.setDate(a.getDate()-1)),n.tasks=ko.observableArray([]),n.listDateMS=null!==e&&e.listDateMS?e.listDateMS:a.getTime(),n.listDate=ko.computed(function(){return new Date(n.listDateMS)}),n.yesterdayComplete=0,n.previousTaskTotal=0,n.listDate().toLocaleDateString()===a.toLocaleDateString()||(n.listDate().toLocaleDateString()===s.toLocaleDateString()?null!==e&&e.tasks.length>0&&$.each(e.tasks,function(e,t){t.CompleteYesterday=t.Complete,t.Complete=!1}):null!==e&&e.tasks.length>0&&$.each(e.tasks,function(e,t){t.Complete=!1,t.CompleteYesterday=!1})),n.listDateMS=a.getTime(),null!==e&&e.tasks.length>0&&$.each(e.tasks,function(e,t){var o=new Task(t.Id,t.Name,t.Complete,t.CompleteYesterday);n.previousTaskTotal++,t.CompleteYesterday&&n.yesterdayComplete++,n.tasks.push(o)}),n.allComplete=ko.computed(function(){var e=!0;return $.each(n.tasks(),function(t,o){o.complete()===!1&&(e=!1)}),e}),n.tasksComplete=ko.computed(function(){var e=0;return $.each(n.tasks(),function(t,o){o.complete()===!0&&e++}),e+" of "+n.tasks().length+" today"}),n.tasksYesterday=ko.computed(function(){return n.yesterdayComplete+" of "+n.previousTaskTotal+" yesterday"}),n.addTask=function(){n.tasks.push(new Task(o(),"",!1,!1))},n.removeTask=function(e){n.tasks.remove(e)},n.store=function(){var e=n.toJSON(),o=JSON.stringify(e);localStorage.setItem(t,o)}}var App;(window.localStorage===void 0||window.sessionStorage===void 0)&&function(){var e=function(e){function t(e,t,o){var n,a;o?(n=new Date,n.setTime(n.getTime()+1e3*60*60*24*o),a="; expires="+n.toGMTString()):a="",document.cookie=e+"="+t+a+"; path=/"}function o(e){var t,o,n=e+"=",a=document.cookie.split(";");for(t=0;a.length>t;t++){for(o=a[t];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(n))return o.substring(n.length,o.length)}return null}function n(o){o=JSON.stringify(o),"session"==e?window.name=o:t("localStorage",o,365)}function a(){"session"==e?window.name="":t("localStorage","",365)}function s(){var t="session"==e?window.name:o("localStorage");return t?JSON.parse(t):{}}var r=s();return{length:0,clear:function(){r={},this.length=0,a()},getItem:function(e){return void 0===r[e]?null:r[e]},key:function(e){var t=0;for(var o in r){if(t==e)return o;t++}return null},removeItem:function(e){delete r[e],this.length--,n(r)},setItem:function(e,t){r[e]=t+"",this.length++,n(r)}}};window.localStorage===void 0&&(window.localStorage=new e("local")),window.sessionStorage===void 0&&(window.sessionStorage=new e("session"))}(),ko.bindingHandlers.store={update:function(e,t,o,n){var a=t();o(),ko.utils.unwrapObservable(a);var s=n.id();localStorage.setItem(s,ko.toJSON(n)),App.store()}},AppModel.prototype.toJSON=function(){var e=ko.toJS(this);return e},function(){"use strict";function e(){var e,t=!1;return{log:function(e){console&&t&&console.log(e)},init:function(t){var o=window.localStorage.getItem(t),n=JSON.parse(o);e=new AppModel(n,t),ko.applyBindings(e)},store:function(){e.store()},status:function(){return ko.toJSON(e)},newDate:function(){return new Date}}}App=new e}(jQuery);